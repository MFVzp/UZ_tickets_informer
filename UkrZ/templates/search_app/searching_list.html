{% extends 'base.html' %}
{% load staticfiles %}
{% block extra_stiles %}
    <link rel="stylesheet" type="text/css" href="{% static 'search_app/searching_list.css' %}">
{% endblock %}
{% block content %}
    {% if search_list %}
        <table id="searching_res_table" border="1" cellspacing="0">
            <thead>
                <tr>
                    <th class="w-25">Результат</th>
                    <th class="w-25">Станция отправления</th>
                    <th class="w-25">Станция назначения</th>
                    <th>Дата отправления</th>
                    <th>Тип<br>места</th>
                    <th>Кол-во<br>мест</th>
                </tr>
            </thead>
            {% for search in search_list %}
            <tbody>
                <tr>
                    {% if search.is_actual %}
                        <td class="bg-success text-white">В работе</td>
                    {% else %}
                        <td class="text-left">
                        {% if search.fail_result %}
                            search.fail_result.fail_message
                        {% elif search.success_results.all %}
                            {% for result in search.success_results.all %}
                                <p class="mb-0">Поезд <b>{{ result.train }}</b></p>
                                <p class="mb-0">Дата отправления <b>{{ result.date_from|date:"d.m.Y H:i" }}</b></p>
                                <p class="mb-0">Дата прибытия <b>{{ result.date_till|date:"d.m.Y H:i" }}</b></p>
                                <p class="mb-0">Вагон <b>№{{ result.carriage }}</b></p>
                                <p>Мест{{ result.coaches|pluralize:"а,о" }}: <b>{{ result.coaches }}</b></p>
                            {% endfor %}
                        {% else %}
                            Странно, но результатов нет(попробуйте возобновить поиск).
                        {% endif %}
                        </td>
                    {% endif %}
                    <td>{{ search.station_from }}</td>
                    <td>{{ search.station_till }}</td>
                    <td>{{ search.date_dep }}</td>
                    <td>{{ search.coach_type }}</td>
                    <td>{{ search.amount_of_coaches }}</td>
                </tr>
            </tbody>
            {% endfor %}
        </table>
    {% else %}
        <h2 class="text-center mt-5">Нет запросов. Хотите ли Вы <a href="{% url 'search:add' %}">создать</a> запрос?</h2>
    {% endif %}
{% endblock content %}